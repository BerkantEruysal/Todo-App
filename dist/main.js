(()=>{"use strict";const e=function(e){let t;return n.map((n=>{n.todos.forEach((n=>{n.id==e&&(t=n)}))})),t},t=function(e){let t;return n.forEach((n=>{n.id==e&&(t=n)})),t};let n=[{color:"#FF9924",title:"Default",todos:[],isVisible:!0,isDone:!1,isSelected:!0,id:1,priority:1}];const i=()=>n;function o(){let e=[],t=1;return i().forEach((t=>{e.push(t.id),t.todos.forEach((t=>{e.push(t.id)}))})),e.forEach((()=>{d(t,e)&&t++})),t}const d=function(e,t){return t.some((t=>t==e))};let c=1;const l=()=>c;let r=[],s=[];const a=function(t){const n=e(t),i=document.createElement("div"),o=document.createElement("h4"),d=document.createElement("p"),c=document.createElement("p"),l=document.createElement("button"),s=document.createElement("button"),a=document.createElement("button"),m=document.createElement("div");o.innerHTML=n.title,d.innerHTML=n.description,c.innerHTML=n.deadline,l.innerHTML=n.isDone?"undone":"done",s.innerHTML="delete",a.innerHTML="edit",m.className="button-div",s.addEventListener("click",(()=>{y(t)})),l.addEventListener("click",(()=>L(n,i))),a.addEventListener("click",(()=>{0==f(t).isEditing&&(I(n.id),f(t).isEditing=!0)})),i.className="todo-item",i.id=n.id,i.style.backgroundColor=n.color,i.appendChild(o),i.appendChild(d),i.appendChild(c),m.appendChild(l),m.appendChild(s),m.appendChild(a),i.appendChild(m),r.push({elementContainer:i,title:o,description:d,date:c,doneBtn:l,id:t,isEditing:!1})},m=function(e){const n=t(e),i=document.createElement("div"),o=document.createElement("h3"),d=document.createElement("p"),c=document.createElement("button"),l=document.createElement("button"),r=document.createElement("button"),a=document.createElement("button");o.innerHTML=n.title,o.className="project-title",d.innerHTML=`Todos in project : ${n.todos.length}`,c.innerHTML=n.isVisible?"hide":"show",l.innerHTML="Delete Project",r.innerHTML="Edit",a.innerHTML=n.isSelected?"selected":"select",i.style.backgroundColor=n.color,i.id=e,i.classList.add("project-element"),l.addEventListener("click",(()=>C(n.id))),r.addEventListener("click",(()=>{0==h(e).isEditing&&(H(e),h(e).isEditing=!0)})),a.addEventListener("click",(()=>{0==n.isSelected&&(T(e),E(e))})),c.addEventListener("click",(()=>{1==t(e).isVisible?k(e):D(e)})),i.appendChild(o),i.appendChild(d),i.appendChild(c),i.appendChild(r),i.appendChild(a),i.appendChild(l),s.push({elementContainer:i,title:o,totalTodos:d,visibilityBtn:c,deleteBtn:l,editBtn:r,selectBtn:a,id:e,isEditing:!1})},u=function(e){r.splice(r.indexOf(f(e)),1),document.getElementById(e).remove()},p=function(t){const n=f(t),i=e(t);n.title.innerHTML=i.title,n.description.innerHTML=i.description,n.date.innerHTML=i.deadline,n.doneBtn.innerHTML=i.isDone?"undone":"done",n.elementContainer.style.backgroundColor=i.color},E=function(e){const n=h(e),i=t(e);n.title.innerHTML=i.title,n.totalTodos.innerHTML=`Todos in project : ${i.todos.length}`,n.visibilityBtn.innerHTML=i.isVisible?"hide":"show",n.selectBtn.innerHTML=i.isSelected?"selected":"select",n.elementContainer.style.backgroundColor=i.color,i.isSelected?(n.elementContainer.classList.add("selected-project"),document.getElementById("project-name").innerHTML="Currnet project : "+i.title):n.elementContainer.classList.remove("selected-project"),document.getElementById("project-name").style.backgroundColor=t(l()).color,i.todos.forEach((e=>{e.color=i.color,1==i.isVisible&&p(e.id)}))},f=function(e){let t;return r.forEach((n=>{n.id==e&&(t=n)})),t},h=function(e){let t;return s.forEach((n=>{n.id==e&&(t=n)})),t},v=function(e){document.getElementById("td-list").appendChild(f(e).elementContainer)},g=function(e){document.getElementById("project-list").appendChild(h(e).elementContainer)},L=function(e,t){e.isDone=!e.isDone,1==e.isDone?t.classList.add("done-todo"):t.classList.remove("done-todo"),p(e.id)},y=function(n){const i=t(e(n).project_id);1==i.isVisible&&u(n),function(n,i){t(n);const o=t(n).todos.indexOf(e(i));t(n).todos.splice(o,1)}(e(n).project_id,n),E(i.id)},C=function(e){[...t(e).todos].forEach((e=>{y(e.id)})),l()==e&&T(i()[0].id),function(e){s.splice(s.indexOf(h(e)),1),document.getElementById(e).remove()}(e),(e=>{n.splice(n.indexOf(t(e)),1)})(e),0==i().length&&(document.getElementById("project-name").innerHTML="There is no project here ;(")},B=function(){document.getElementById("form-todo-title").value="",document.getElementById("form-todo-description").value="",document.getElementById("form-todo-date").value="",document.getElementById("todo-form").classList.add("hidden")},j=function(){document.getElementById("form-project-title").value="",document.getElementById("project-form").classList.add("hidden")},T=function(e){const n=t(e);h(e).elementContainer.classList.add("selected-project");const i=l();var o;o=n.id,t(c).isSelected=!1,c=o,t(c).isSelected=!0,E(i),document.getElementById("project-name").innerHTML="Selected project: : "+n.title,document.getElementById("project-name").style.backgroundColor=n.color},I=function(t){const n=e(t),i=document.createElement("div"),o=document.createElement("input"),d=document.createElement("input"),c=document.createElement("input"),l=document.createElement("button"),r=document.createElement("button"),s=document.createElement("p"),a=document.createElement("p"),m=document.createElement("p");s.innerHTML="Title : ",a.innerHTML="Description : ",m.innerHTML="Deadline : ",r.innerHTML="save",l.innerHTML="X",c.type="date",i.className="todo-edit-form",i.id=`${t}-edit-form`,r.addEventListener("click",(()=>{!function(t,{project_id:n,title:i,deadline:o,description:d,isDone:c,color:l,priority:r}){const s=e(t);s.project_id=n,s.title=i,s.deadline=o,s.description=d,s.isDone=c,s.color=l,s.priority=r}(t,{project_id:e(t).project_id,title:o.value,deadline:c.value,description:d.value,isDone:e(t).isDone,color:e(t).color,priority:e(t).priority}),p(t),f(t).isEditing=!1,b(t)})),l.addEventListener("click",(()=>b(t))),o.value=n.title,d.value=n.description,c.value=n.deadline,i.appendChild(l),i.appendChild(s),i.appendChild(o),i.appendChild(a),i.appendChild(d),i.appendChild(m),i.appendChild(c),i.appendChild(r),i.appendChild(l),document.getElementById(t).appendChild(i)},b=function(e){f(e).isEditing=!1,document.getElementById(e+"-edit-form").remove()},H=function(e){const n=t(e),i=document.createElement("div"),o=document.createElement("input"),d=document.createElement("input"),c=document.createElement("button"),l=document.createElement("button"),r=document.createElement("p"),s=document.createElement("p");o.value=n.title,r.innerHTML="Title : ",d.type="color",d.value=n.color,c.innerHTML="X",l.innerHTML="save",s.innerHTML="Color : ",i.id=`${e}-edit-form`,i.className="project-edit-form",l.addEventListener("click",(()=>{!function(e,{color:n,title:i,isVisible:o,priority:d,isDone:c}){const l=t(e);l.color=n,l.title=i,l.isVisible=o,l.priority=d,l.isDone=c}(e,{color:d.value,title:o.value,isVisible:n.isVisible,priority:n.priority,isDone:n.isDone}),E(e),M(e)})),c.addEventListener("click",(()=>M(e))),i.appendChild(c),i.appendChild(r),i.appendChild(o),i.appendChild(s),i.appendChild(d),i.appendChild(l),document.getElementById(e).appendChild(i)},M=function(e){h(e).isEditing=!1,document.getElementById(e+"-edit-form").remove()},k=function(e){h(e).elementContainer.classList.add("hidden-project"),t(e).isVisible=!1,t(e).todos.forEach((e=>{u(e.id)})),E(e)},D=function(e){h(e).elementContainer.classList.remove("hidden-project"),t(e).isVisible=!0,t(e).todos.forEach((e=>{a(e.id),v(e.id)})),E(e)};document.getElementById("form-todo-create").addEventListener("click",(e=>{if(0==i().length)return void alert("Please create a project first.");if(""==document.getElementById("form-todo-title").value.replace(/\s/g,"")||""==document.getElementById("form-todo-description").value.replace(/\s/g,""))return void alert("Please give a title and a description to your todo");const n=document.getElementById("form-todo-title").value,d=document.getElementById("form-todo-description").value,c=document.getElementById("form-todo-date").value,r=function(e,n,i,d){const c={project_id:e,title:n,deadline:i,description:d,isDone:!1};return c.color=t(e).color,c.priority=t(e).todos.length,c.id=o(),c}(l(),n,c,d);!function(e,n){t(n).todos.push(e)}(r,l()),1==t(l()).isVisible&&(a(r.id),v(r.id)),E(r.project_id),B()})),document.getElementById("form-todo-close").addEventListener("click",(()=>B())),document.getElementById("create-todo").addEventListener("click",(()=>{document.getElementById("todo-form").classList.remove("hidden")})),document.getElementById("form-project-create").addEventListener("click",(()=>{if(""==document.getElementById("form-project-title").value.replace(/\s/g,""))return void alert("Please give a title to your new project");const e=document.getElementById("form-project-title").value,t=function(e,t){const n={color:e,title:t,todos:[],isVisible:!0,isDone:!1,isSelected:!0};return n.id=o(),n.priority=i().length,n}(document.getElementById("form-project-color").value,e);(e=>{n.push(e)})(t),m(t.id),T(t.id),g(t.id),j()})),document.getElementById("create-project").addEventListener("click",(()=>{document.getElementById("project-form").classList.remove("hidden")})),document.getElementById("form-project-close").addEventListener("click",(()=>j())),document.getElementById("form-project-color").value="#99CDD6",m(1),T(1),g(1)})();